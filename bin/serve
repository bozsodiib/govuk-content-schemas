#!/usr/bin/env ruby

$LOAD_PATH << File.dirname(__FILE__) + "/../lib"

require 'rack'
require 'thin'
require 'optparse'
require 'govuk_content_schemas/content_item_example_app'

options = {
  interface: '0.0.0.0',
  port: 3000
}

OptionParser.new do |opts|
  opts.on("-i", "--interface [IP ADDRESS]", "Interface (default 0.0.0.0)") do |interface|
    options[:interface] = interface
  end
  opts.on("-p", "--port [PORT]", "Run on specified port (default 3000)") do |port|
    options[:port] = port
  end
end.parse!

Thin::Server.start(options[:interface], options[:port]) do
  use Rack::CommonLogger

  map '/content' do
    run GovukContentSchemas::ContentItemExampleApp.new(File.dirname(__FILE__) + "/../formats")
  end
end
